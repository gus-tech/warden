{{extend 'layout.html'}}
<h1>This is the warden/index.html template</h1>
{{=BEAUTIFY(response._vars)}}




<script>
    var ws = null
    $( document ).ready(document_ready)
    function document_ready(){
        ws_ready()
    }

    function ws_ready(){
        console.log(ws)
        if(ws == null || ws.readyState != 1){
            ws = $.web2py.web2py_websocket("{{=ws_connection_string}}");
            ws.onmessage = ws_on_message;
            ws.onopen = ws_on_open;
            ws.onclose = ws_on_close;
            return false;
        } else{
            return true;
        }
    }
    
    function ws_on_open(){}
    function ws_on_close(){}

    function ws_on_message(e){
        try{data = JSON.parse(e.data)}
        catch(err){console.log(e.data); return false}
        try{window[data['callback']](data);}
        catch(err){console.log(e.data)}
    }

    function ws_on_close(e){
        $('#ipam_report_button').prop('disabled', true);
        get_report_status()
    }
    
</script>
